<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/icon" href="../media/icons/icon.png">
  <title>Bethel Studio — Admin</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <!-- Admin CSS -->
  <link rel="stylesheet" href="css/admin.css">
</head>
<body>

  <!-- ════════════════════════════════
       HEADER
  ════════════════════════════════ -->
  <header class="header">
    <div class="navbar" id="navbar">

      <!-- Logo -->
      <div class="logo-container" id="logo">
        <img src="../media/icons/IMG-20240712-WA0019.jpg" alt="Bethel Logo" class="logo-image">
        <span class="logo-text">B<span class="gold-accent">E</span>TH<span class="gold-accent">E</span>L Studio</span>
      </div>

      <!-- Hamburger (mobile only) -->
      <button class="nav-trigger" id="navTrigger" aria-label="Toggle menu">
        <i class="fa-solid fa-bars"></i>
      </button>

      <!-- Desktop nav -->
      <nav class="main-nav-desktop" id="navigation">
        <ul>
          <li>
            <!-- "Welcome" is a real nav button — triggers the intro panel -->
            <button class="nav-link-btn" data-target="intro" aria-label="Go to Welcome">
              <i class="fa-solid fa-house fa-sm"></i> Welcome
            </button>
          </li>
          <li>
            <a id="logoutButton" class="logout-link" role="button" tabindex="0">
              <i class="fa-solid fa-right-from-bracket fa-sm"></i> Log out
            </a>
          </li>
        </ul>
      </nav>

    </div>
  </header>

  <!-- Mobile sidebar overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- ════════════════════════════════
       MAIN LAYOUT
  ════════════════════════════════ -->
  <div class="main-layout-container">

    <!-- ── SIDEBAR ── -->
    <aside class="sidebar-nav" id="sidebar-nav">

      <div class="sidebar-menu-group">
        <span class="group-heading">Home</span>
        <button class="nav-button" data-target="HomeCTA"><i class="fa-solid fa-bullhorn fa-xs"></i> Hero CTA</button>
        <button class="nav-button" data-target="scriptureOfDay"><i class="fa-solid fa-book-open fa-xs"></i> Scripture of the Day</button>
        <button class="nav-button" data-target="presidentMessage"><i class="fa-solid fa-crown fa-xs"></i> El Presidente's Message</button>
      </div>

      <div class="sidebar-menu-group">
        <span class="group-heading">Service</span>
        <button class="nav-button" data-target="servicesbody"><i class="fa-solid fa-calendar-days fa-xs"></i> Bethel Service</button>
        <button class="nav-button" data-target="bethel_songs"><i class="fa-solid fa-music fa-xs"></i> Bethel Songs</button>
      </div>

      <div class="sidebar-menu-group">
        <span class="group-heading">Gallery</span>
        <button class="nav-button" data-target="picture"><i class="fa-solid fa-images fa-xs"></i> Picture Post</button>
        <button class="nav-button" data-target="memories"><i class="fa-solid fa-photo-film fa-xs"></i> Memory Albums</button>
        <button class="nav-button" data-target="updates"><i class="fa-solid fa-newspaper fa-xs"></i> Updates &amp; Stories</button>
      </div>

      <div class="sidebar-menu-group">
        <span class="group-heading">History</span>
        <button class="nav-button" data-target="B_commit"><i class="fa-solid fa-people-group fa-xs"></i> Bethel Committee</button>
        <button class="nav-button" data-target="annual_achivements"><i class="fa-solid fa-trophy fa-xs"></i> Annual Achievements</button>
      </div>

      <div class="sidebar-menu-group">
        <span class="group-heading">Events</span>
        <button class="nav-button" data-target="remarkable"><i class="fa-solid fa-star fa-xs"></i> Remarkable Event</button>
      </div>

      <p class="sidebar-footer">
        Developed by
        <a href="https://tristechhub.org.rw" target="_blank" rel="noopener">
          <span class="LimeSpan">Tris Tech Hub</span>
        </a>
      </p>

      <div id="error" class="error-message hidden">
        <p class="error-icon">&times; Error</p>
        <p>Error submitting data to the database.</p>
      </div>

      <div id="image-preview-container" class="image-preview-box hidden">
        <p>Image Preview</p>
        <img id="image-preview" src="https://placehold.co/150x100/1a1a1a/FFD700?text=Preview" alt="Preview">
      </div>

    </aside>

    <!-- ── WORKSPACE ── -->
    <section class="workspace">

      <!-- ─────────────────────────────
           WELCOME / INTRO
      ───────────────────────────────── -->
      <div class="content-panel" id="intro" style="display:block;">
        <div class="intro-card">

          <!-- Hero banner -->
          <div class="intro-hero">
            <img src="../media/icons/IMG-20240712-WA0019.jpg" alt="Bethel Family Choir" class="intro-logo">
            <h2>Welcome to Bethel Studio</h2>
            <p class="intro-tagline">Your administrative platform for all Bethel content</p>
          </div>

          <!-- Stats -->
          <div class="overview">
            <h2>Website Overview</h2>
            <div class="statistics">
              <div class="statDiv">
                <h3>Songs</h3>
                <p id="Songs">—</p>
              </div>
              <div class="statDiv">
                <h3>Pictures</h3>
                <p id="Pictures">—</p>
              </div>
              <div class="statDiv">
                <h3>Committees</h3>
                <p id="Committes">—</p>
              </div>
              <div class="statDiv">
                <h3>Annual Achievements</h3>
                <p id="YearsRecorded">—</p>
              </div>
            </div>
          </div>

          <!-- Quick-link activities -->
          <div class="description">
            <p>Click any task below to jump straight to that section:</p>
            <h3>Key Activities</h3>
            <ul class="activities">
              <li>
                <button class="activity-link" data-target="B_commit">
                  <i class="fa-solid fa-people-group"></i>
                  Register a new Committee
                  <i class="fa-solid fa-arrow-right activity-arrow"></i>
                </button>
              </li>
              <li>
                <button class="activity-link" data-target="updates">
                  <i class="fa-solid fa-newspaper"></i>
                  Create a story for Updates
                  <i class="fa-solid fa-arrow-right activity-arrow"></i>
                </button>
              </li>
              <li>
                <button class="activity-link" data-target="picture">
                  <i class="fa-solid fa-images"></i>
                  Post a picture to the Gallery
                  <i class="fa-solid fa-arrow-right activity-arrow"></i>
                </button>
              </li>
              <li>
                <button class="activity-link" data-target="memories">
                  <i class="fa-solid fa-photo-film"></i>
                  Create a Memory for the Gallery
                  <i class="fa-solid fa-arrow-right activity-arrow"></i>
                </button>
              </li>
              <li>
                <button class="activity-link" data-target="annual_achivements">
                  <i class="fa-solid fa-trophy"></i>
                  Post Annual Achievements to History
                  <i class="fa-solid fa-arrow-right activity-arrow"></i>
                </button>
              </li>
            </ul>
          </div>

        </div>
      </div>

      <!-- ─────────────────────────────
           HERO CTA
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="HomeCTA">
        <h2><i class="fa-solid fa-bullhorn fa-sm"></i> Edit Call to Action</h2>
        <div class="pageSelector committe-Action" id="pageSelector">
          <button class="page-button" data-target="Home">Home</button>
          <button class="page-button" data-target="Service">Service</button>
          <button class="page-button" data-target="Gallery">Gallery</button>
          <button class="page-button" data-target="History">History</button>
          <button class="page-button" data-target="About">About us</button>
        </div>
        <form action="" method="post" id="CTAform">
          <label for="headingCTA">Heading</label>
          <input type="text" name="headingCTA" id="headingCTA" placeholder="Enter page heading" required>
          <label for="caption">Caption</label>
          <input type="text" name="caption" id="caption" placeholder="Enter caption text" required>
          <input type="text" class="hidden" name="pageselected" id="pageselected">
          <button type="submit"><i class="fa-solid fa-floppy-disk fa-sm"></i> Update CTA</button>
        </form>
      </div>

      <!-- ─────────────────────────────
           BETHEL COMMITTEE
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="B_commit">
        <h2><i class="fa-solid fa-people-group fa-sm"></i> <span id="staffTitle">Register a New Committee</span></h2>
        <div class="committe-Action" id="committeAction">
          <button class="page-button selectedpage" data-target="New">New</button>
        </div>
        <form id="staff-form" method="post" enctype="multipart/form-data">
          <div class="table-wrapper">
            <table id="staff-table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Post Held</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><input type="text" name="names[]" placeholder="Enter name" required></td>
                  <td><input type="text" name="posts[]" placeholder="Enter post held" required></td>
                  <td class="action-cell">
                    <button type="button" class="delete-btn" title="Remove row">
                      <i class="fa-solid fa-trash-can"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <button type="button" id="add-row-btn"><i class="fa-solid fa-plus fa-xs"></i> Add Row</button>
          <label for="pictureCommitte">Committee Picture</label>
          <input type="file" name="featured_image" accept="image/*" class="image-input" id="pictureCommitte">
          <label>Choir's Decree</label>
          <input type="text" name="ecree" placeholder="Choir's Decree">
          <label>Committee Era</label>
          <input type="text" name="period" placeholder="e.g. 2023–2024">
          <input type="text" name="url" class="hidden">
          <input type="number" name="commit_id" id="commit_id" class="hidden">
          <button type="submit" id="submit-btn" name="B_commit_save">
            <i class="fa-solid fa-floppy-disk fa-sm"></i> Save Committee
          </button>
          <div id="deleteContainer"></div>
        </form>
      </div>

      <!-- ─────────────────────────────
           SCRIPTURE OF THE DAY
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="scriptureOfDay">
        <h2><i class="fa-solid fa-book-open fa-sm"></i> Scripture of the Day</h2>
        <form action="" method="post" id="ScriptureForm">
          <label for="ScriptureTitle">Scripture Reference (e.g. John 3:16)</label>
          <input type="text" name="ScriptureTitle" id="ScriptureTitle" required placeholder="e.g. John 3:16">
          <label for="ScriptureMeaning">Content</label>
          <textarea name="ScriptureMeaning" id="ScriptureMeaning" required placeholder="Scripture text here..."></textarea>
          <button type="submit"><i class="fa-solid fa-floppy-disk fa-sm"></i> Update Scripture</button>
        </form>
      </div>

      <!-- ─────────────────────────────
           PRESIDENT MESSAGE
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="presidentMessage">
        <h2><i class="fa-solid fa-crown fa-sm"></i> A Word from El Presidente</h2>
        <form action="" method="post" id="presidentWordForm">
          <img class="profilePic" src="https://placehold.co/200x200/1a1a1a/FFD700?text=Photo" alt="Profile Photo" id="Pic">
          <label for="uploadPic">Upload Picture</label>
          <input type="file" name="Mypost" accept="image/*" id="uploadPic">
          <label for="presidentName">Name</label>
          <input type="text" name="presidentName" id="presidentName" placeholder="President's full name" required>
          <label for="message">Message</label>
          <textarea name="message" id="message" placeholder="Write the president's message..." required></textarea>
          <button type="submit"><i class="fa-solid fa-floppy-disk fa-sm"></i> Update Message</button>
        </form>
      </div>

      <!-- ─────────────────────────────
           ANNUAL ACHIEVEMENTS
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="annual_achivements">
        <h2><i class="fa-solid fa-trophy fa-sm"></i> <span id="achievementTitle">Annual Achievements</span></h2>
        <div class="committe-Action" id="annual_achivementsAction">
          <button class="page-button selectedpage" data-target="New">New</button>
        </div>
        <form action="" method="post" id="yearForm" enctype="multipart/form-data">
          <label for="year">Year (e.g. 2024 or 2024–2025)</label>
          <input type="text" name="year" id="year" required placeholder="e.g. 2024">
          <input type="number" name="yearId" id="yearId" class="hidden">
          <label>Summary of the Year</label>
          <div class="alert">
            <ul>
              <li>Gold text: <code>&lt;span class="goldenSpan"&gt;text&lt;/span&gt;</code></li>
              <li>Olive text: <code>&lt;span class="oliveSpan"&gt;text&lt;/span&gt;</code></li>
              <li>Italic: <code>&lt;i&gt;text&lt;/i&gt;</code></li>
            </ul>
          </div>
          <textarea name="yearContext" id="yearContext" placeholder="Summary of the year's achievements..." required></textarea>
          <button type="submit" name="submitAnnual"><i class="fa-solid fa-floppy-disk fa-sm"></i> Save Annual Report</button>
          <div id="actionbox"></div>
        </form>
      </div>

      <!-- ─────────────────────────────
           PICTURE POST / GALLERY
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="picture">
        <h2><i class="fa-solid fa-images fa-sm"></i> Gallery Images</h2>
        <div class="table-wrapper">
          <table id="image-list">
            <thead>
              <tr>
                <th>Caption</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="pictureTableBody">
              <tr>
                <td>shimo sezerano second adelin</td>
                <td class="action-cell">
                  <button type="button" class="status-button status-active-button">Active</button>
                  <button type="button" class="edit-btn"><i class="fa-solid fa-pen-to-square fa-xs"></i> Edit</button>
                  <button type="button" class="delete-btn" title="Delete"><i class="fa-solid fa-trash-can"></i></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <button type="button" id="add-row-btn4" class="primary-action-button">
          <i class="fa-solid fa-plus fa-xs"></i> Post Another Image
        </button>
        <form action="" method="" enctype="multipart/form-data" id="imagePostForm">
          <h2 id="pictureFormTitle">Post to Gallery</h2>
          <img src="https://placehold.co/300x200/1a1a1a/FFD700?text=New+Image" alt="Post Preview" id="Mypost2">
          <label for="imagePost">Upload Picture</label>
          <input type="file" name="Mypost" accept="image/*" id="imagePost">
          <label for="ImageCaption">Image Caption</label>
          <input type="text" name="ImageCaption" id="ImageCaption" placeholder="Describe this image" required>
          <input type="number" name="pictureId" id="pictureId" class="hidden">
          <input type="text" name="url" id="url" class="hidden">
          <button type="submit" name="submitPost"><i class="fa-solid fa-cloud-arrow-up fa-sm"></i> Post to Gallery</button>
        </form>
      </div>

      <!-- ─────────────────────────────
           MEMORY ALBUM
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="memories">
        <h2><i class="fa-solid fa-photo-film fa-sm"></i> Create a Memory Album</h2>
        <form action="" method="post" enctype="multipart/form-data">
          <label>Album Name</label>
          <input type="text" name="memory_id" placeholder="e.g. Mission Trip 2024" required>
          <div class="table-wrapper">
            <table id="memory-images">
              <thead>
                <tr><th>Image File</th><th>Action</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td><input type="file" name="memories[]" accept="image/*" class="image-input" required></td>
                  <td class="action-cell">
                    <button type="button" class="delete-btn" title="Remove">
                      <i class="fa-solid fa-trash-can"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <button type="button" id="add-memory-row"><i class="fa-solid fa-plus fa-xs"></i> Add Image</button>
          <button type="submit" name="submitMemory"><i class="fa-solid fa-cloud-arrow-up fa-sm"></i> Post Memory Album</button>
        </form>
      </div>

      <!-- ─────────────────────────────
           UPDATES / STORY
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="updates">
        <h2><i class="fa-solid fa-newspaper fa-sm"></i> Create a Story for Updates</h2>
        <form action="" method="post" enctype="multipart/form-data">
          <label for="headline">Story Headline</label>
          <input type="text" name="headline" id="headline" placeholder="Compelling headline..." required>
          <img src="https://placehold.co/300x150/1a1a1a/FFD700?text=Cover+Image" alt="Update Preview" id="Myupdate">
          <label for="updateImage">Upload Cover Image</label>
          <input type="file" name="updateImage" accept="image/*" id="updateImage" required>
          <label for="storyContext">Story Content</label>
          <textarea name="storyContext" id="storyContext" placeholder="Write the full story..." required></textarea>
          <button type="submit" name="submitupdate"><i class="fa-solid fa-cloud-arrow-up fa-sm"></i> Post Update Story</button>
        </form>
      </div>

      <!-- ─────────────────────────────
           BETHEL SONGS
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="bethel_songs">
        <h2><i class="fa-solid fa-music fa-sm"></i> Songs &amp; Performances</h2>
        <div class="table-wrapper">
          <table id="song-list">
            <thead>
              <tr><th>Song Title</th><th>Actions</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Shimo Sezerano — Second Adelin</td>
                <td class="action-cell">
                  <button type="button" class="edit-btn"><i class="fa-solid fa-pen-to-square fa-xs"></i> Edit</button>
                  <button type="button" class="delete-btn" title="Delete"><i class="fa-solid fa-trash-can"></i></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <button type="button" id="add-row-btn3" class="primary-action-button">
          <i class="fa-solid fa-plus fa-xs"></i> Add Song
        </button>
        <form action="" method="post" id="SongForm">
          <h2 id="SongFormTitle">Add a Song</h2>
          <label for="titleSong">Song Title</label>
          <input type="text" name="titleSong" id="titleSong" placeholder="Song title" required>
          <label for="linkSong">Video / Audio Link</label>
          <input type="text" name="linkSong" id="linkSong" placeholder="e.g. https://youtube.com/..." required>
          <input type="number" id="songId" class="hidden">
          <button type="submit" name="submitSong"><i class="fa-solid fa-floppy-disk fa-sm"></i> Save Song</button>
        </form>
      </div>

      <!-- ─────────────────────────────
           SERVICE FLYER
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="servicesbody">
        <h2><i class="fa-solid fa-calendar-days fa-sm"></i> Post Sunday Service Flyer</h2>
        <form action="" method="post" enctype="multipart/form-data" id="flyerForm">
          <img src="https://placehold.co/300x400/1a1a1a/FFD700?text=Service+Flyer" alt="Flyer Preview" id="Myupdate2">
          <label for="updateImage2">Upload Service Flyer</label>
          <input type="file" name="featured_image" accept="image/*" id="updateImage2">
          <div class="flyer-actions">
            <button type="button" id="status-btn" data-status="0">
              <i class="fa-solid fa-circle-dot fa-sm"></i> Inactive
            </button>
            <button type="submit" name="servicePost">
              <i class="fa-solid fa-cloud-arrow-up fa-sm"></i> Post Flyer
            </button>
          </div>
        </form>
      </div>

      <!-- ─────────────────────────────
           REMARKABLE EVENT
      ───────────────────────────────── -->
      <div class="content-panel hidden" id="remarkable">
        <h2><i class="fa-solid fa-star fa-sm"></i> Post a Remarkable Event</h2>
        <form action="" method="post" enctype="multipart/form-data">
          <label for="titleEvent">Title</label>
          <input type="text" name="titleEvent" id="titleEvent" required placeholder="Event title">
          <label for="dateEvent">Date</label>
          <input type="date" name="dateEvent" id="dateEvent" required>
          <label for="pictureEvent">Picture</label>
          <input type="file" name="pictureEvent" accept="image/*" class="image-input" id="pictureEvent" required>
          <label>Description</label>
          <textarea name="describeEvent" placeholder="Give some description..." required></textarea>
          <button type="submit" name="submitRemark"><i class="fa-solid fa-floppy-disk fa-sm"></i> Save Event</button>
        </form>
      </div>

      <!-- ─────────────────────────────
           MESSAGE BOX (bottom-right toast)
      ───────────────────────────────── -->
      <div class="message-box-overlay" id="messageBoxOverlay"></div>
      <div class="message-box" id="messageBox" role="dialog" aria-modal="true" aria-labelledby="messageBoxTitle">
        <div class="message-box-header">
          <div class="message-box-icon" id="messageBoxIcon">
            <i class="fa-solid fa-circle-question"></i>
          </div>
          <h4 id="messageBoxTitle"></h4>
        </div>
        <p id="messageBoxContent"></p>
        <div class="message-box-buttons">
          <button class="form-button form-button--cancel" id="messageBoxCancelBtn" style="display:none;">
            <i class="fa-solid fa-xmark fa-sm"></i> Cancel
          </button>
          <button class="form-button form-button--confirm" id="messageBoxConfirmBtn">
            <i class="fa-solid fa-check fa-sm"></i> Confirm
          </button>
        </div>
      </div>

      <!-- Image hover viewer -->
      <div id="image-viewer" class="hidden">
        <img id="viewer-image" src="" alt="Preview">
      </div>

    </section>
  </div><!-- /.main-layout-container -->

  <!-- ══════════════════════════════════════════
       INLINE SCRIPTS
       Runs synchronously before dashboard.js module
  ══════════════════════════════════════════ -->
  <script>
    /* ── Sidebar overlay sync ──
       dashboard.js owns navTrigger → calls sidebar.classList.toggle('open')
       We observe and mirror to overlay. */
    (function () {
      const sidebar = document.getElementById('sidebar-nav');
      const overlay = document.getElementById('sidebarOverlay');

      new MutationObserver(() => {
        overlay.classList.toggle('visible', sidebar.classList.contains('open'));
      }).observe(sidebar, { attributes: true, attributeFilter: ['class'] });

      overlay.addEventListener('click', () => sidebar.classList.remove('open'));

      // Auto-close drawer on nav-button click at ≤1024px
      sidebar.addEventListener('click', (e) => {
        if (e.target.closest('.nav-button') && window.innerWidth <= 1024)
          sidebar.classList.remove('open');
      });
    })();

    /* ── penNav shim ──
       dashboard.js has a typo: calls penNav() instead of openNav(). */
    window.penNav = function () {
      document.getElementById('sidebar-nav').classList.toggle('open');
    };

    /* ── Quick-links & Welcome nav button ──
       Both activity buttons (.activity-link) and the navbar Welcome button
       (.nav-link-btn) call show_div2. Since dashboard.js is a module that
       loads after this script, we proxy through window.show_div2 which
       dashboard.js must expose on window. */
    document.addEventListener('click', function (e) {
      const link = e.target.closest('[data-target].activity-link, [data-target].nav-link-btn');
      if (link) {
        e.preventDefault();
        const target = link.dataset.target;
        if (typeof window.show_div2 === 'function') {
          window.show_div2(target);
        } else {
          // Queue it — dashboard.js will pick it up once loaded
          window._pendingNav = target;
        }
      }
    });
  </script>

  <!-- dashboard.js — must call window.show_div2 = show_div2 to expose it -->
  <script type="module" src="javascript/dashboard.js"></script>
</body>
</html>